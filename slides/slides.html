<!DOCTYPE html>
<html>
<head>
  <title>Computational Reproducibility and Good Graphics</title>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="slides_files/rmdshower/node_modules/shower-ribbon/styles/screen-4x3.css">
  <link rel="stylesheet" href="slides_files/rmdshower/style-common.css">
  <link rel="stylesheet" href="slides_files/rmdshower/style-ribbon.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.js"></script>
  <script src="slides_files/rmdshower/auto-render.min.js" type="text/javascript"></script>
  
  
    <style type="text/css">
   div.sourceCode { overflow-x: auto; }
   table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
     margin: 0; padding: 0; vertical-align: baseline; border: none; }
   table.sourceCode { width: 100%; line-height: 100%; }
   td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
   td.sourceCode { padding-left: 5px; }
   code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
   code > span.dt { color: #902000; } /* DataType */
   code > span.dv { color: #40a070; } /* DecVal */
   code > span.bn { color: #40a070; } /* BaseN */
   code > span.fl { color: #40a070; } /* Float */
   code > span.ch { color: #4070a0; } /* Char */
   code > span.st { color: #4070a0; } /* String */
   code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
   code > span.ot { color: #007020; } /* Other */
   code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
   code > span.fu { color: #06287e; } /* Function */
   code > span.er { color: #ff0000; font-weight: bold; } /* Error */
   code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
   code > span.cn { color: #880000; } /* Constant */
   code > span.sc { color: #4070a0; } /* SpecialChar */
   code > span.vs { color: #4070a0; } /* VerbatimString */
   code > span.ss { color: #bb6688; } /* SpecialString */
   code > span.im { } /* Import */
   code > span.va { color: #19177c; } /* Variable */
   code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
   code > span.op { color: #666666; } /* Operator */
   code > span.bu { } /* BuiltIn */
   code > span.ex { } /* Extension */
   code > span.pp { color: #bc7a00; } /* Preprocessor */
   code > span.at { color: #7d9029; } /* Attribute */
   code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
   code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
   code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
   code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  
  
  
</head>

<body class="shower list">

  <header class="caption">
    <h1>Computational Reproducibility and Good Graphics</h1>
    <p>Heike Hofmann</p>
  </header>

    
  
<section id="computational-reproducibility-and-good-graphics" class="titleslide slide level1"><h2 class="shout">Computational Reproducibility and Good Graphics</h2></section><section id="science-retracts-gay-marriage-paper-without-agreement-of-lead-author" class="slide level2">
<h2>Science retracts gay marriage paper without agreement of lead author</h2>
<ul>
<li>May 2015: Science retracts paper of how canvassers can sway people’s opinions about gay marriage.</li>
<li>Science Editor-in-Chief: (1) Original survey data not made available for independent reproduction of results (2) Survey incentives misrepresented (3) Sponsorship statement false</li>
<li>Two Berkeley grad students attempted to replicate the study and discovered that the data must have been faked.</li>
<li>Outright fraud cannot be prevented by reproducibility methods, but the methods make it easier to discover such issues.</li>
</ul>
<p><small> Source: <a href="http://news.sciencemag.org/policy/2015/05/science-retracts-gay-marriage-paper-without-lead-author-s-consent" class="uri">http://news.sciencemag.org/policy/2015/05/science-retracts-gay-marriage-paper-without-lead-author-s-consent</a> </small></p>
</section><section id="seizure-study-retracted-after-authors-realize-data-got-terribly-mixed" class="slide level2">
<h2>Seizure study retracted after authors realize data got “terribly mixed”</h2>
<p>From the authors of <strong>Low Dose Lidocaine for Refractory Seizures in Preterm Neonates</strong>:</p>
<p><em>“The article has been retracted at the request of the authors. After carefully re-examining the data presented in the article, they identified that data of two different hospitals got terribly mixed. The published results cannot be reproduced in accordance with scientific and clinical correctness.”</em></p>
<p><small> Source: <a href="http://retractionwatch.com/2013/02/01/seizure-study-retracted-after-authors-realize-data-got-terribly-mixed/" class="uri">http://retractionwatch.com/2013/02/01/seizure-study-retracted-after-authors-realize-data-got-terribly-mixed/</a> </small></p>
</section><section id="bad-spreadsheet-merge-kills-depression-paper-quick-fix-resurrects-it" class="slide level2">
<h2>Bad spreadsheet merge kills depression paper, quick fix resurrects it</h2>
<ul>
<li>The authors informed the journal that the merge of lab results and other survey data used in the paper resulted in an error regarding the identification codes.</li>
<li><strong>Original conclusion:</strong> Lower levels of CSF IL-6 were associated with current depression and with future depression […].</li>
<li><strong>Revised conclusion:</strong> Higher levels of CSF IL-6 and IL-8 were associated with current depression […].</li>
</ul>
<p><small> Source: <a href="http://retractionwatch.com/2014/07/01/bad-spreadsheet-merge-kills-depression-paper-quick-fix-resurrects-it/" class="uri">http://retractionwatch.com/2014/07/01/bad-spreadsheet-merge-kills-depression-paper-quick-fix-resurrects-it/</a> </small></p>
</section><section id="keith-baggerly-founder-of-bioinformatic-forensics" class="slide level2">
<h2>Keith Baggerly: Founder of “Bioinformatic Forensics”</h2>
<ul>
<li>Start of the so-called <em>Potti retractions</em>: <a href="http://videolectures.net/cancerbioinformatics2010_baggerly_irrh/" class="uri">http://videolectures.net/cancerbioinformatics2010_baggerly_irrh/</a></li>
<li>by now Anil Potti was forced to retract four papers</li>
<li>Five cancer drug studies exhibited “several simple errors” <a href="http://projecteuclid.org/euclid.aoas/1267453942">Annals of Applied Statistics 2009</a> (mislabeling, row/column offsets) to the point that the exact opposite drug was given to participants resulting in likely avoidable deaths.</li>
</ul>
</section>
<section id="what-canshould-we-do" class="titleslide slide level1"><h2 class="shout">What can/should we do?</h2></section><section id="four-facets-of-reproducibility" class="slide level2">
<h2>Four facets of reproducibility</h2>
<ol type="1">
<li><strong>Documentation:</strong> avoid binary files (e.g. docx) and use text files for documentation
<ul>
<li>Use markdown to document our workflow so that anyone can pick up our data and follow what we are doing</li>
<li>Use literate programming so that our analysis and our results are tightly connected, or better yet, unseparable</li>
</ul></li>
<li><strong>Organization:</strong> tools to organize our projects so that we don’t have a single folder with hundreds of files</li>
<li><strong>Automation:</strong> the power of scripting to create automated data analyses</li>
<li><strong>Dissemination:</strong> publishing is not the end of our analysis, rather it is a way station towards future research and the future research of others</li>
</ol>
</section><section id="a-bit-about-me" class="slide level2">
<h2>A bit about me</h2>
<ul>
<li>Professor in Statistics (at ISU since 2002)</li>
<li>research area: Statistical Computing and Data Visualization</li>
<li>former graduate students: Hadley Wickham (ggplot2, tidyverse) and Yihui Xie (knitr, RMarkdown) both work for RStudio now</li>
<li>my tools: R and RStudio</li>
</ul>
</section><section id="why-r-r-is" class="slide level2">
<h2>Why R? – R is …</h2>
<ul>
<li><strong>Free</strong> to use</li>
<li><strong>Extensible</strong>: Over 10,000 user contributed add-on packages currently on CRAN!</li>
<li><strong>Powerful</strong>: With the right tools, get more work done, faster.</li>
<li><strong>Flexible</strong>: Not a question of <em>can</em>, but <em>how</em>.</li>
<li><strong>Frustrating</strong>: Flexibility comes at a cost (easy to shoot yourself in the foot!).</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pkgs &lt;-<span class="st"> </span><span class="kw">available.packages</span>(<span class="dt">contriburl =</span> 
                      <span class="kw">contrib.url</span>(<span class="st">&quot;https://cran.rstudio.com/&quot;</span>, 
                                      <span class="dt">type =</span> <span class="st">&quot;both&quot;</span>))
<span class="kw">nrow</span>(pkgs)</code></pre></div>
<pre><code>## [1] 10352</code></pre>
</section><section id="rstudio-is" class="slide level2 black">
<h2>RStudio is …</h2>
<p><a href="http://jules32.github.io/resources/RStudio_intro/">From Julie Lowndes</a>:</p>
<p><img class="cover" src="images/airport-light.png" alt=""></p>
<blockquote>
<p style="color:white">
<b>If R were an airplane, RStudio would be the airport</b>, providing many, many supporting services that make it easier for you, the pilot, to take off and go to awesome places. Sure, you can fly an airplane without an airport, but having those runways and supporting infrastructure is a game-changer.
</p>
</blockquote>
</section><section id="the-rstudio-ide" class="slide level2">
<h2>The RStudio IDE</h2>
<p><img class="cover" src="images/rstudio-panes.png" alt=""></p>
</section><section id="the-rstudio-ide-1" class="slide level2">
<h2>The RStudio IDE</h2>
<ol type="1">
<li><strong>Source editor:</strong> Docking station for multiple files, Useful shortcuts (“Knit”), Highlighting/Tab-completion, Code-checking (R, HTML, JS), Debugging features<br />
</li>
<li><strong>Console window:</strong> Highlighting/Tab-completion, Search recent commands</li>
<li><strong>Environment pane:</strong> Tools for package development, git, etc</li>
<li><strong>Other tabs/panes:</strong> Graphics, R documentation, File system navigation/access</li>
</ol>
<br> <br>
<p class="note">
<em>Protip:</em> save yourself the headaches figuring out file paths and instead work in an RStudio R project (popup menu at the top left)
</p>
</section><section id="markdown" class="slide level2">
<h2>Markdown</h2>
<ul>
<li>Markdown is a particular type of <strong>markup</strong> language.</li>
<li>Markup languages are designed to <strong>produce documents from plain text</strong>.</li>
<li>Some of you may be familiar with <strong>LaTeX</strong>. This is another (less human friendly) markup language for creating pdf documents.</li>
<li>LaTeX gives you much greater control, but it is restricted to pdf and has a much greater learning curve.</li>
<li><strong>Markdown</strong> is becoming a <strong>standard</strong>. Many websites will generate HTML from Markdown (e.g. GitHub, Stack Overflow, reddit, …).</li>
</ul>
</section><section id="markdown-is-easy" class="slide level2">
<h2>Markdown is easy</h2>
<pre><code>*italic*
**bold**

# Header 1
## Header 2
### Header 3

- List item 1
- List item 2
    - item 2a
    - item 2b

1. Numbered list item 1
1. Numbered list item 2
    - item 2a
    - item 2b</code></pre>
<p>Have a look at RStudio’s <a href="https://www.rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf">RMarkdown cheat sheet</a></p>
</section><section id="what-is-rmarkdown" class="slide level2">
<h2>What is RMarkdown?</h2>
<ul>
<li>… an authoring format that enables easy creation of dynamic documents, presentations, and reports from R.</li>
<li>it combines the core syntax of markdown with embedded R code chunks that are run so their output can be included in the final document.</li>
<li>R Markdown documents are fully reproducible (they are automatically regenerated whenever underlying R code or data changes).</li>
</ul>
</section><section id="why-r-markdown" class="slide level2">
<h2>Why R Markdown?</h2>
<ul>
<li><strong>It’s simple.</strong> Focus on writing, rather than debugging silly errors.</li>
<li><strong>It’s flexible.</strong> Markdown was created to simplify writing HTML, but thanks to pandoc, Markdown converts to many different formats!</li>
<li><strong>It’s dynamic.</strong> Find a critical error? Get a new dataset? Regenerate your report without copy/paste hell!</li>
<li><strong>Encourages transparency.</strong> Collaborators (including your future self) will thank you for integrating your analysis &amp; report.</li>
<li><strong>Enables interactivity/reactivity.</strong> Allow your audience to explore the analysis (rather than passively read it).</li>
</ul>
</section><section id="section" class="slide level2 white">
<h2></h2>
<p><img class="cover" src="images/rmarkdown.png" alt=""></p>
</section><section id="section-1" class="slide level2 white">
<h2></h2>
<p><img class="cover" src="images/hello-rmarkdown.png" alt=""></p>
</section><section id="your-turn-5-min" class="slide level2 white">
<h2>Your Turn (5 min)</h2>
<p><img class="cover" src="images/yourturn.jpg" alt=""></p>
<ol type="1">
<li><span style="color:white">Open RStudio, create a new project.</span></li>
<li><span style="color:white">Create a new RMarkdown file and knit it.</span></li>
<li><span style="color:white">Navigate to the RMarkdown cheat sheet and download a copy (Google for the link!)</span></li>
<li><span style="color:white">Make changes to the markdown formatting and knit again.</span></li>
<li><span style="color:white">Export to a different file format.</span></li>
<li><span style="color:white">If you feel adventurous, change some of the R code and knit again.</span></li>
</ol>
</section><section id="using-stata" class="slide level2">
<h2>Using Stata</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(knitr)
statapath &lt;-<span class="st"> </span>
<span class="st">  &quot;/Applications/Stata/StataSE.app/Contents/MacOS/stata-se&quot;</span>
<span class="co"># for Windows:</span>
<span class="co"># statapath &lt;- &quot;C:/Program Files (x86)/Stata14/StataSE-64.exe&quot;</span>

opts_chunk$<span class="kw">set</span>(<span class="dt">engine=</span><span class="st">&quot;stata&quot;</span>, <span class="dt">engine.path=</span>statapath, <span class="dt">comment=</span><span class="st">&quot;&quot;</span>)</code></pre></div>
<h3 id="descriptive-statistics">Descriptive Statistics</h3>
<p>A simple example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sysuse auto
summarize</code></pre></div>
</section><section id="computational-reproducibility-a-case-study" class="slide level2">
<h2>Computational Reproducibility: a case study</h2>
<ul>
<li>Visual representations of the decennial census starting with 1870 (ceased after 1920, revived for 2000)</li>
<li>each Atlas is compendium of about 100 lithographic plates (format is 2 x 3 ft, some charts are double pages)</li>
<li>huge technical feat: data collection, data aggregation, visualization and print technology</li>
<li>unique insight into life in the United States</li>
<li>also unique insight into statistical graphics</li>
<li>made available through Library of Congress <a href="https://www.loc.gov/resource/g3701gm.gct00008/?st=gallery" class="uri">https://www.loc.gov/resource/g3701gm.gct00008/?st=gallery</a></li>
</ul>
</section><section id="plate-32" class="slide level2">
<h2>Plate #32</h2>
<p><img src="images/occupations-us.png" width = 300> <img src="images/legend.png" width = 250></p>
<ul>
<li><em>Gainful</em> occupation or going to school</li>
<li>Inner square is a mosaicplot (at the time a novel visualization)</li>
<li>What proportion of the population is unaccounted for?</li>
</ul>
</section><section id="data-infrastructure" class="slide level2">
<h2>Data infrastructure</h2>
<blockquote>
<p>
An article about computational science in a scientific publication is not the scholarship itself, it is merely advertising of the scholarship. The actual scholarship is the complete software development environment and the complete set of instructions which generated the figures.
</p>
</blockquote>
<p>Buckheit &amp; Donoho (1995)</p>
<ul>
<li><a href="https://data2.nhgis.org/main">NHGIS</a> (National Historical Geographical Information system): aggregates of Census data at different geographic levels</li>
<li><a href="https://usa.ipums.org/usa-action/variables/group">IPUMS-USA</a>: U.S. Census and American Community Survey microdata from 1850 to the present</li>
</ul>
</section><section id="nhgis-extract" class="slide level2">
<h2>NHGIS extract</h2>
<pre><code>Table 5:     Employed Population by Occupation by Age by Sex
Universe:    Employed Persons
Source code: NT13
NHGIS code:  ALL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nhgis &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;../data/nhgis-iowa.csv&quot;</span>)
<span class="kw">head</span>(nhgis[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>)], <span class="dv">10</span>)</code></pre></div>
<pre><code>##     GISJOIN   G190                               GIS.Join.Match.Code
## 1      YEAR   1870                                    Data File Year
## 2     STATE   Iowa                                        State Name
## 3    STATEA    190                                        State Code
## 4  AREANAME   Iowa                                         Area name
## 5    ALL001  11243      Agriculture &gt;&gt; 10 to 15 years of age &gt;&gt; Male
## 6    ALL002     26    Agriculture &gt;&gt; 10 to 15 years of age &gt;&gt; Female
## 7    ALL003 187264      Agriculture &gt;&gt; 16 to 59 years of age &gt;&gt; Male
## 8    ALL004    274    Agriculture &gt;&gt; 16 to 59 years of age &gt;&gt; Female
## 9    ALL005  11400   Agriculture &gt;&gt; 60 years of age and over &gt;&gt; Male
## 10   ALL006     56 Agriculture &gt;&gt; 60 years of age and over &gt;&gt; Female</code></pre>
</section><section id="ipums-extract" class="slide level2">
<h2>IPUMS extract</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iowa &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;../data/ipums-iowa.csv&quot;</span>)
<span class="kw">head</span>(iowa)</code></pre></div>
<pre><code>##   YEAR  SERIAL STATEICP STATEFIP URBAN PERNUM    SEX AGE BIRTHYR  RACE
## 1 1870 2001101     Iowa       19 Rural      1   Male  26    1844 White
## 2 1870 2001101     Iowa       19 Rural      2 Female  20    1850 White
## 3 1870 2001101     Iowa       19 Rural      3   Male   1    1869 White
## 4 1870 2001101     Iowa       19 Rural      4   Male   0    1870 White
## 5 1870 2001201     Iowa       19 Rural      1   Male  21    1849 White
## 6 1870 2001201     Iowa       19 Rural      2 Female  18    1852 White
##                                NATIVITY CITIZEN SCHOOL LIT BLIND NAMELAST
## 1 Native born, both parents native born       2      1   4    No   ROMANS
## 2 Native born, both parents native born       0      1   4    No   ROMANS
## 3 Native born, both parents native born       0      1   0    No   ROMANS
## 4 Native born, both parents native born       0      1   0    No   ROMANS
## 5 Native born, both parents native born       2      1   4    No   DEATON
## 6 Native born, both parents native born       0      1   4    No   DEATON
##   NAMEFRST
## 1  FRELAND
## 2      ANN
## 3  WILLIAM
## 4 THEODORE
## 5  CLAYTON
## 6    SARAH</code></pre>
</section><section id="old-and-new---side-by-side" class="slide level2">
<h2>Old and new - side by side</h2>
<div class="double">
<p class="double-flow">
<img src="images/occupations-us.png" width = 250>
</p>
<p class="double-flow">
<img src="slides_files/figure-revealjs/us-repro-1.png" width = 500>
</p>
</div>
<ul>
<li>visually size of rectangles seem to coincide</li>
<li>better: use digitized picture as data source</li>
</ul>
</section><section id="digitized-and-estimated-values" class="slide level2">
<h2>Digitized and Estimated Values</h2>
<p><img src="slides_files/figure-revealjs/unnamed-chunk-6-1.png" width="768" /></p>
</section><section id="really-new-plot" class="slide level2">
<h2>Really new plot</h2>
<p><img src="slides_files/figure-revealjs/us-repro-with-1.png" width="768" /></p>
<ul>
<li>about 30% of the population over ten is not accounted for</li>
<li>97% of them are girls and women!</li>
</ul>
</section><section id="conclusions" class="slide level2">
<h2>Conclusions</h2>
<ul>
<li>the Census Bureau’s dedication to preserving the historical data and charts make a reproduction possible</li>
<li>most charts created today do not have the same commitment to historical preservation</li>
<li>today’s tools make it easier to reproduce results (not for 150 years, but for at least 5-10 years) <br> <br></li>
<li>material to re-produce these slides available on <a href="">github</a>.</li>
</ul>
</section>

  <!--
  To hide progress bar from entire presentation
  just remove “progress” element.
  -->
  <!-- <div class="progress"></div> -->
  <script src="slides_files/rmdshower/node_modules/shower/node_modules/shower-core/shower.min.js"></script>
  <!-- Copyright © 2015 Yours Truly, Famous Inc. -->
  <!-- Photos by John Carey, fiftyfootshadows.net -->

    <script>renderMathInElement(document.body);</script>
  
  
</body>
</html>
